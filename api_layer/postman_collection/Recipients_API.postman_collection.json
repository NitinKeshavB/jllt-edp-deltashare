{
	"info": {
		"_postman_id": "a1b2c3d4-e5f6-4a5b-8c9d-0e1f2a3b4c5d",
		"name": "Delta Share - Recipients API",
		"description": "Complete API collection for managing Delta Share recipients (D2D and D2O)",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8000",
			"type": "string"
		},
		{
			"key": "workspace_url",
			"value": "https://adb-xxxx.azuredatabricks.net",
			"type": "string"
		},
		{
			"key": "recipient_name",
			"value": "test_recipient",
			"type": "string"
		}
	],
	"item": [
		{
			"name": "List All Recipients",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "X-Workspace-URL",
						"value": "{{workspace_url}}",
						"type": "text"
					}
				],
				"url": {
					"raw": "{{base_url}}/recipients?prefix=&page_size=100",
					"host": ["{{base_url}}"],
					"path": ["recipients"],
					"query": [
						{
							"key": "prefix",
							"value": "",
							"description": "Optional prefix filter for recipient names"
						},
						{
							"key": "page_size",
							"value": "100",
							"description": "Maximum number of recipients to return (default: 100)"
						}
					]
				},
				"description": "List all recipients with optional prefix filtering and pagination"
			},
			"response": []
		},
		{
			"name": "Get Recipient by Name",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "X-Workspace-URL",
						"value": "{{workspace_url}}",
						"type": "text"
					}
				],
				"url": {
					"raw": "{{base_url}}/recipients/{{recipient_name}}",
					"host": ["{{base_url}}"],
					"path": ["recipients", "{{recipient_name}}"]
				},
				"description": "Get details of a specific recipient by name. Returns recipient information including authentication type, owner, IP access list (D2O only), and activation details."
			},
			"response": []
		},
		{
			"name": "Create D2D Recipient (Databricks-to-Databricks)",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "X-Workspace-URL",
						"value": "{{workspace_url}}",
						"type": "text"
					}
				],
				"url": {
					"raw": "{{base_url}}/recipients/d2d/{{recipient_name}}?recipient_identifier=azure:eastus:12345678-1234-1234-1234-123456789012&description=D2D recipient for partner company&sharing_code=",
					"host": ["{{base_url}}"],
					"path": ["recipients", "d2d", "{{recipient_name}}"],
					"query": [
						{
							"key": "recipient_identifier",
							"value": "azure:eastus:12345678-1234-1234-1234-123456789012",
							"description": "Metastore ID in format: cloud:region:uuid (e.g., azure:eastus:xxx, aws:us-west-2:xxx, gcp:us-central1:xxx)"
						},
						{
							"key": "description",
							"value": "D2D recipient for partner company",
							"description": "Description of the recipient"
						},
						{
							"key": "sharing_code",
							"value": "",
							"description": "Optional sharing code for activation"
						}
					]
				},
				"description": "Create a Databricks-to-Databricks (D2D) recipient. Uses DATABRICKS authentication type. Requires the recipient's metastore ID in format: cloud:region:uuid. IP access lists are NOT supported for D2D recipients."
			},
			"response": []
		},
		{
			"name": "Create D2O Recipient (Databricks-to-Open)",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "X-Workspace-URL",
						"value": "{{workspace_url}}",
						"type": "text"
					}
				],
				"url": {
					"raw": "{{base_url}}/recipients/d2o/{{recipient_name}}?description=D2O recipient for external partner&ip_access_list=192.168.1.100,10.0.0.0/24,172.16.0.0/12",
					"host": ["{{base_url}}"],
					"path": ["recipients", "d2o", "{{recipient_name}}"],
					"query": [
						{
							"key": "description",
							"value": "D2O recipient for external partner",
							"description": "Description of the recipient"
						},
						{
							"key": "ip_access_list",
							"value": "192.168.1.100,10.0.0.0/24,172.16.0.0/12",
							"description": "Comma-delimited list of IP addresses or CIDR blocks (e.g., '192.168.1.1,10.0.0.0/24'). Optional."
						}
					]
				},
				"description": "Create a Databricks-to-Open (D2O) recipient with TOKEN authentication. Supports comma-delimited IP access list for restricting access. Returns activation URL and access token for the recipient to use."
			},
			"response": []
		},
		{
			"name": "Delete Recipient",
			"request": {
				"method": "DELETE",
				"header": [
					{
						"key": "X-Workspace-URL",
						"value": "{{workspace_url}}",
						"type": "text"
					}
				],
				"url": {
					"raw": "{{base_url}}/recipients/{{recipient_name}}",
					"host": ["{{base_url}}"],
					"path": ["recipients", "{{recipient_name}}"]
				},
				"description": "Delete a recipient by name. User must be the owner. This will permanently remove the recipient and revoke all access tokens."
			},
			"response": []
		},
		{
			"name": "Rotate Recipient Token (D2O only)",
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "X-Workspace-URL",
						"value": "{{workspace_url}}",
						"type": "text"
					}
				],
				"url": {
					"raw": "{{base_url}}/recipients/{{recipient_name}}/tokens/rotate?expire_in_seconds=0",
					"host": ["{{base_url}}"],
					"path": ["recipients", "{{recipient_name}}", "tokens", "rotate"],
					"query": [
						{
							"key": "expire_in_seconds",
							"value": "0",
							"description": "Time in seconds until new token expires (0 = no expiration). Must be non-negative."
						}
					]
				},
				"description": "Rotate the access token for a D2O recipient. Only works with TOKEN authentication type (D2O recipients). Returns new token and activation URL. Note: Recipients have a maximum number of active tokens allowed."
			},
			"response": []
		},
		{
			"name": "Add IP Addresses to Recipient (D2O only)",
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "X-Workspace-URL",
						"value": "{{workspace_url}}",
						"type": "text"
					}
				],
				"url": {
					"raw": "{{base_url}}/recipients/{{recipient_name}}/ipaddress/add?ip_access_list=203.0.113.10,198.51.100.0/24,192.0.2.1",
					"host": ["{{base_url}}"],
					"path": ["recipients", "{{recipient_name}}", "ipaddress", "add"],
					"query": [
						{
							"key": "ip_access_list",
							"value": "203.0.113.10,198.51.100.0/24,192.0.2.1",
							"description": "Comma-delimited list of IP addresses or CIDR blocks to add (e.g., '192.168.1.1,10.0.0.0/24')"
						}
					]
				},
				"description": "Add IP addresses or CIDR blocks to a D2O recipient's allow list. Accepts comma-delimited list of IPs and CIDR blocks. Only works with TOKEN authentication (D2O recipients). Each IP is validated before adding."
			},
			"response": []
		},
		{
			"name": "Revoke IP Addresses from Recipient (D2O only)",
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "X-Workspace-URL",
						"value": "{{workspace_url}}",
						"type": "text"
					}
				],
				"url": {
					"raw": "{{base_url}}/recipients/{{recipient_name}}/ipaddress/revoke?ip_access_list=203.0.113.10,198.51.100.0/24",
					"host": ["{{base_url}}"],
					"path": ["recipients", "{{recipient_name}}", "ipaddress", "revoke"],
					"query": [
						{
							"key": "ip_access_list",
							"value": "203.0.113.10,198.51.100.0/24",
							"description": "Comma-delimited list of IP addresses or CIDR blocks to revoke (e.g., '192.168.1.1,10.0.0.0/24')"
						}
					]
				},
				"description": "Remove IP addresses or CIDR blocks from a D2O recipient's allow list. Accepts comma-delimited list. IPs must exist in current list to be revoked. Only works with TOKEN authentication (D2O recipients)."
			},
			"response": []
		},
		{
			"name": "Update Recipient Description",
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "X-Workspace-URL",
						"value": "{{workspace_url}}",
						"type": "text"
					}
				],
				"url": {
					"raw": "{{base_url}}/recipients/{{recipient_name}}/description/update?description=Updated description for the recipient",
					"host": ["{{base_url}}"],
					"path": ["recipients", "{{recipient_name}}", "description", "update"],
					"query": [
						{
							"key": "description",
							"value": "Updated description for the recipient",
							"description": "New description (cannot be empty or contain only spaces/quotes)"
						}
					]
				},
				"description": "Update the description of a recipient. User must be the owner. Description cannot be empty or contain only spaces and quotes."
			},
			"response": []
		},
		{
			"name": "Update Recipient Expiration Time (D2O only)",
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "X-Workspace-URL",
						"value": "{{workspace_url}}",
						"type": "text"
					}
				],
				"url": {
					"raw": "{{base_url}}/recipients/{{recipient_name}}/expiration_time/update?expiration_time_in_days=90",
					"host": ["{{base_url}}"],
					"path": ["recipients", "{{recipient_name}}", "expiration_time", "update"],
					"query": [
						{
							"key": "expiration_time_in_days",
							"value": "90",
							"description": "Number of days until expiration (must be positive integer)"
						}
					]
				},
				"description": "Update the expiration time for a D2O recipient's tokens. Only works with TOKEN authentication type (D2O recipients). User must be the owner. Expiration time must be a positive integer."
			},
			"response": []
		}
	]
}
